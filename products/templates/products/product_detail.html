{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-5">
    <div class="row">
        <!-- Product Image -->
        <div class="col-md-6 mb-4">
            {% if product.image_url %}
            <img src="{{ product.image_url }}" class="img-fluid" alt="{{ product.name }}">
            {% elif product.image %}
            <img src="{{ product.image.url }}" class="img-fluid" alt="{{ product.name }}">
            {% else %}
            <img src="https://via.placeholder.com/600x600?text=No+Image" class="img-fluid" alt="No image">
            {% endif %}
        </div>

        <!-- Product Info -->
        <div class="col-md-6">
            <h2>{{ product.name }}</h2>
            <p class="text-muted">SKU: {{ product.sku }}</p>

            {% if product.rating %}
            <p class="text-warning mb-3">
                <i class="fas fa-star"></i> {{ product.rating|floatformat:1 }}
            </p>
            {% endif %}

            <h3 class="text-danger mb-4">Â£{{ product.price }}</h3>

            <!-- Description Section -->
            <h5>Product Description</h5>
            <p class="mb-4">{{ product.description }}</p>

            <hr class="my-4">

            <!-- Size Selector -->
            {% if product.has_sizes %}
            <form method="POST" action="{% url 'add_to_cart' product.id %}">
                {% csrf_token %}

                {% if product.category.name == 'gloves' %}
                <!-- Gloves get OZ dropdown -->
                <div class="mb-3">
                    <label for="product_size" class="form-label fw-bold">Select Weight:</label>
                    <select name="product_size" id="product_size" class="form-select" required>
                        <option value="">Choose weight...</option>
                        <option value="8oz">8oz</option>
                        <option value="10oz">10oz</option>
                        <option value="12oz">12oz</option>
                        <option value="14oz">14oz</option>
                        <option value="16oz">16oz</option>
                    </select>
                </div>
                {% else %}
                <!-- Everything else gets regular sizes -->
                <div class="mb-3">
                    <label for="product_size" class="form-label fw-bold">Select Size:</label>
                    <select name="product_size" id="product_size" class="form-select" required>
                        <option value="">Choose size...</option>
                        <option value="XS">XS</option>
                        <option value="S">S</option>
                        <option value="M">M</option>
                        <option value="L">L</option>
                        <option value="XL">XL</option>
                        <option value="XXL">XXL</option>
                    </select>
                </div>
                {% endif %}

                <div class="mb-3">
                    <label for="quantity" class="form-label fw-bold">Quantity:</label>
                    <div class="input-group" style="max-width: 150px;">
                        <button class="btn btn-outline-secondary" type="button" id="decrement-qty">
                            <i class="fas fa-minus"></i>
                        </button>
                        <input type="number" name="quantity" id="quantity" class="form-control text-center" value="1"
                            min="1" max="99" readonly>
                        <button class="btn btn-outline-secondary" type="button" id="increment-qty">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                <input type="hidden" name="redirect_url" value="{{ request.path }}">

                <button type="submit" class="btn btn-danger btn-lg w-100">
                    <i class="fas fa-shopping-bag me-2"></i>Add to Cart
                </button>
            </form>
            {% else %}
            <!-- No sizes condition -->
            <form method="POST" action="{% url 'add_to_cart' product.id %}">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="quantity" class="form-label fw-bold">Quantity:</label>
                    <input type="number" name="quantity" id="quantity" class="form-control" value="1" min="1" max="99">
                </div>
                <input type="hidden" name="redirect_url" value="{{ request.path }}">
                <button type="submit" class="btn btn-danger btn-lg w-100">
                    <i class="fas fa-shopping-bag me-2"></i>Add to Cart
                </button>
            </form>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/product_detail.js' %}"></script>
{% endblock %}